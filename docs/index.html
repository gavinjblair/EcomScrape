<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EcomScrape | Home</title>
  <meta name="description" content="EcomScrape is a data explorer and analytics dashboard for scraped e-commerce catalogues.">
  <meta property="og:title" content="EcomScrape - E-commerce Data Explorer & Analytics">
  <meta property="og:description" content="Explore product data, filter by category and price, and view analytics dashboards.">
  <meta property="og:type" content="website">
  <link rel="stylesheet" href="assets/tailwind.css">
  <link rel="stylesheet" href="assets/custom.css">
</head>
<body class="min-h-screen text-white relative overflow-x-hidden bg-[radial-gradient(circle_at_top,_#1a1f3a_0,_#060912_60%)]">
  <div class="pointer-events-none absolute -top-24 -left-24 w-96 h-96 rounded-full bg-primary/30 blur-3xl"></div>
  <div class="pointer-events-none absolute bottom-0 right-0 w-[28rem] h-[28rem] rounded-full bg-accentTo/20 blur-3xl"></div>
  <div class="flex min-h-screen relative z-10">
    <aside class="relative flex flex-col h-screen w-56 bg-white/10 backdrop-blur-xl border-r border-white/10 shadow-[0_0_25px_rgba(0,0,0,0.4)] p-5 gap-4 sticky top-0 overflow-hidden">
      <div class="absolute left-0 top-0 h-full w-[1px] bg-white/10"></div>
      <div class="flex items-center gap-3 text-xl font-bold">
        EcomScrape
      </div>
      <nav class="flex flex-col gap-2 text-sm">
        <a class="relative flex items-center gap-3 px-4 py-2 rounded-xl text-white hover:bg-white/10 hover:text-white transition bg-primary/40 shadow-[0_0_20px_rgba(58,123,255,0.45)] before:absolute before:inset-0 before:rounded-xl before:bg-primary/20 before:blur-xl before:-z-10" href="index.html">Home</a>
        <a class="relative flex items-center gap-3 px-4 py-2 rounded-xl text-white/75 hover:bg-white/10 hover:text-white transition" href="products.html">Products</a>
        <a class="relative flex items-center gap-3 px-4 py-2 rounded-xl text-white/75 hover:bg-white/10 hover:text-white transition" href="analytics.html">Analytics</a>
      </nav>
      <div class="mt-auto flex flex-col gap-3"></div>
    </aside>

    <main class="flex-1 p-6 lg:p-10 overflow-y-auto">
      <div class="max-w-6xl mx-auto space-y-12">
        <section class="bg-white/15 backdrop-blur-xl border border-white/30 rounded-3xl shadow-[0_20px_60px_rgba(0,0,0,0.55)] p-8 lg:p-10 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] transition glass-topline">
          <h1 class="text-4xl font-bold tracking-tight mb-3">EcomScrape - E-commerce Data Explorer & Analytics</h1>
          <p class="text-sm text-white/75 max-w-2xl mb-6">Config-driven scraping of BooksToScrape with ready-to-use analytics and product exploration.</p>
          <div class="flex flex-wrap gap-3">
            <a href="products.html" class="inline-flex items-center justify-center px-5 py-3 rounded-full bg-gradient-to-r from-primary to-primaryHover text-white font-semibold shadow-lg shadow-primary/40 hover:shadow-primary/70 hover:scale-[1.02] transition focus:outline-none focus:ring-2 focus:ring-primary/60">Explore Products</a>
            <a href="analytics.html" class="inline-flex items-center justify-center px-5 py-3 rounded-full border border-white/30 bg-white/5 text-white hover:bg-white/10 transition focus:outline-none focus:ring-2 focus:ring-primary/60">Open Analytics Dashboard</a>
          </div>
        </section>
        <div class="h-px bg-white/10 mt-2 mb-2"></div>

        <section>
          <h2 class="text-2xl font-semibold mt-10 mb-4">How it works</h2>
          <div class="grid gap-6 md:grid-cols-3">
            <div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-5 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] hover:-translate-y-[1px] transition glass-topline">
              <div class="text-xl mb-2">1</div>
              <h3 class="font-semibold mb-2">Scrape</h3>
              <p class="text-sm text-white/80 leading-relaxed">Config-driven Requests + BeautifulSoup crawl the BooksToScrape catalogue with images, ratings, and links.</p>
            </div>
            <div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-5 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] hover:-translate-y-[1px] transition glass-topline">
              <div class="text-xl mb-2">2</div>
              <h3 class="font-semibold mb-2">Clean</h3>
              <p class="text-sm text-white/80 leading-relaxed">Normalise prices, ratings, and availability into a structured dataset for export.</p>
            </div>
            <div class="bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-5 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] hover:-translate-y-[1px] transition glass-topline">
              <div class="text-xl mb-2">3</div>
              <h3 class="font-semibold mb-2">Explore</h3>
              <p class="text-sm text-white/80 leading-relaxed">Static Tailwind + ApexCharts UI for filtering, sorting, and analytics.</p>
            </div>
          </div>
        </section>

        <section>
          <h2 class="text-2xl font-semibold mt-10 mb-4">Dataset overview</h2>
          <div class="grid gap-4 md:grid-cols-5">
            <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-4 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] transition glass-topline">
              <div class="text-xs uppercase tracking-wide text-white/60">Products</div>
              <div id="kpiCount" class="text-3xl font-semibold mt-1 text-neon">-</div>
            </div>
            <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-4 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] transition glass-topline">
              <div class="text-xs uppercase tracking-wide text-white/60">Min price</div>
              <div id="kpiMin" class="text-3xl font-semibold mt-1 text-neon">-</div>
            </div>
            <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-4 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] transition glass-topline">
              <div class="text-xs uppercase tracking-wide text-white/60">Median price</div>
              <div id="kpiMedian" class="text-3xl font-semibold mt-1 text-neon">-</div>
            </div>
            <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-4 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] transition glass-topline">
              <div class="text-xs uppercase tracking-wide text-white/60">Max price</div>
              <div id="kpiMax" class="text-3xl font-semibold mt-1 text-neon">-</div>
            </div>
            <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl shadow-[0_12px_35px_rgba(0,0,0,0.35)] p-4 hover:shadow-[0_0_20px_rgba(58,123,255,0.45)] transition glass-topline">
              <div class="text-xs uppercase tracking-wide text-white/60">Categories</div>
              <div id="kpiCats" class="text-3xl font-semibold mt-1 text-neon">-</div>
            </div>
          </div>
          <p id="generatedAt" class="text-textSecondary text-sm mt-2"></p>
        </section>

        <section>
          <h2 class="text-2xl font-semibold mt-10 mb-4">Tech stack</h2>
          <div class="flex flex-wrap gap-2">
            <span class="inline-flex items-center px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[0.7rem] text-white/70 hover:bg-white/10">Python</span>
            <span class="inline-flex items-center px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[0.7rem] text-white/70 hover:bg-white/10">Requests</span>
            <span class="inline-flex items-center px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[0.7rem] text-white/70 hover:bg-white/10">BeautifulSoup4</span>
            <span class="inline-flex items-center px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[0.7rem] text-white/70 hover:bg-white/10">Pandas</span>
            <span class="inline-flex items-center px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[0.7rem] text-white/70 hover:bg-white/10">FastAPI</span>
            <span class="inline-flex items-center px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[0.7rem] text-white/70 hover:bg-white/10">Tailwind CSS</span>
            <span class="inline-flex items-center px-2 py-1 rounded-full bg-white/5 border border-white/10 text-[0.7rem] text-white/70 hover:bg-white/10">ApexCharts</span>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script type="module">
    import { loadDataset, humanDate, priceValue } from "./assets/ui.js";
    import "./assets/state.js";

    const kpiCount = document.getElementById("kpiCount");
    const kpiMin = document.getElementById("kpiMin");
    const kpiMedian = document.getElementById("kpiMedian");
    const kpiMax = document.getElementById("kpiMax");
    const kpiCats = document.getElementById("kpiCats");
    const gen = document.getElementById("generatedAt");

    function median(values) {
      if (!values.length) return null;
      const sorted = [...values].sort((a, b) => a - b);
      const mid = Math.floor(sorted.length / 2);
      return sorted.length % 2 ? sorted[mid] : (sorted[mid - 1] + sorted[mid]) / 2;
    }

    function normaliseCategoryValue(value) {
      const raw = String(value || "").trim();
      if (!raw) return "unknown";
      const lower = raw.toLowerCase();
      if (lower === "default" || lower === "add a comment") return "Other";
      return raw;
    }

    async function init() {
      try {
        const { products, generated_at } = await loadDataset();
        const prices = products.map(priceValue).filter(v => v !== null);
        kpiCount.textContent = products.length;
        kpiMin.textContent = prices.length ? Math.min(...prices).toFixed(2) : "-";
        kpiMedian.textContent = prices.length ? median(prices).toFixed(2) : "-";
        kpiMax.textContent = prices.length ? Math.max(...prices).toFixed(2) : "-";
        const cats = [...new Set(products.map(p => normaliseCategoryValue(p.category)))];
        kpiCats.textContent = cats.length;
        gen.textContent = generated_at ? `Dataset generated: ${humanDate(generated_at)}` : "";
      } catch (err) {
        gen.textContent = err.message;
      }
    }
    init();
  </script>
</body>
</html>
